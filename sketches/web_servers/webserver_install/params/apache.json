{
   "Webserver::Install" : {
      "activated" : "webserver",
      "config" : {
         "group" : {
            "args" : [
               "LOGNAME",
               "128"
            ],
            "function" : "getenv"
         },
         "httpd_conf_d" : "/var/tmp/cfdc.d",
         "owner" : {
            "args" : [
               "LOGNAME",
               "128"
            ],
            "function" : "getenv"
         },
         "perms/dir" : "755",
         "perms/file" : "644",
         "root" : "/var/tmp/configuration",
         "template" : {
            "plain" : "/var/tmp/templates/plain.conf",
            "ssl" : "/var/tmp/templates/ssl.conf"
         }
      },
      "credentials" : {
         "bycontext" : {
            "!authorized" : {},
            "authorized" : {
               "cred1" : {
                  "db/host" : "myhost1",
                  "db/name" : "MYDB1",
                  "db/pfile" : "/path/to/password/file1",
                  "db/port" : "1000",
                  "db/user" : "myuser1"
               },
               "cred2" : {
                  "db/host" : "myhost2",
                  "db/name" : "MYDB2",
                  "db/pfile" : "/path/to/password/file2",
                  "db/port" : "2000",
                  "db/user" : "myuser2"
               },
               "cred_all" : {
                  "mailto" : "tzz@lifelogs.com"
               }
            }
         }
      },
      "environments" : {
         "bycontext" : {
            "any" : {
               "dev" : {
                  "credentials" : "cred1 cred_all",
                  "deploy" : {
                     "branch" : "master",
                     "origin" : "https://github.com/cfengine/design-center.git",
                     "path" : "/var/tmp/dc-dev",
                     "runas" : {
                        "args" : [
                           "LOGNAME",
                           "128"
                        ],
                        "function" : "getenv"
                     },
                     "schedule" : "!any",
                     "umask" : "022",
                     "vcs" : "/usr/bin/git"
                  },
                  "profile" : "profile1",
                  "sites" : "site1",
                  "special/setting" : "devsetting"
               },
               "prod" : {
                  "credentials" : "cred2 cred_all",
                  "deploy" : {
                     "branch" : "master",
                     "origin" : "https://github.com/cfengine/design-center.git",
                     "path" : "/var/tmp/dc-prod",
                     "runas" : {
                        "args" : [
                           "LOGNAME",
                           "128"
                        ],
                        "function" : "getenv"
                     },
                     "schedule" : "any",
                     "umask" : "022",
                     "vcs" : "/usr/bin/git"
                  },
                  "profile" : "profile2",
                  "sites" : "site2",
                  "special/setting" : "prodsetting"
               }
            }
         }
      },
      "packages" : {
         "bycontext" : {
            "!noinstall.debian" : [
               "apache2",
               "apache2-doc",
               "apache2-utils"
            ],
            "!noinstall.redhat" : [
               "httpd",
               "httpd-tools",
               "mod_ssl"
            ],
            "noinstall" : []
         }
      },
      "processes" : {
         "bycontext" : {
            "!noinstall.debian" : {
               "/etc/init.d/apache2 restart" : "apache2"
            },
            "!noinstall.redhat" : {
               "/etc/init.d/httpd restart" : "httpd"
            },
            "noinstall" : []
         }
      },
      "profiles" : {
         "bycontext" : {
            "any" : {
               "profile1" : {
                  "auth/htpasswd" : "/path/to/password/file",
                  "feature/myfeature" : "1",
                  "setting/mysetting" : "foobar1"
               },
               "profile2" : {
                  "auth/htpasswd" : false,
                  "feature/myfeature" : "2",
                  "setting/mysetting" : "foobar2"
               }
            }
         }
      },
      "sites" : {
         "bycontext" : {
            "any" : {
               "site1" : {
                  "DirectoryIndex" : "index.html",
                  "DocumentRoot" : "/var/tmp/dc-dev",
                  "ErrorLog" : "/var/log/site1_error_log",
                  "SSLCertificateFile" : "/path/to/certfile",
                  "SSLCertificateKeyFile" : "/path/to/keyfile",
                  "TransferLog" : "/var/log/site1_access_log",
                  "aliases" : "alias1.mysite.com:443 alias2.mysite.com:443",
                  "extras" : "",
                  "favicon" : "/path/to/favicon",
                  "name" : "mysite.com:443",
                  "overrides" : "All",
                  "type" : "ssl",
                  "url_aliases" : "",
                  "vhost" : "$(sys.ipv4):443"
               },
               "site2" : {
                  "DirectoryIndex" : "index.html",
                  "DocumentRoot" : "/var/tmp/dc-prod",
                  "ErrorLog" : "/var/log/site2_error_log",
                  "SSLCertificateFile" : "/path/to/certfile",
                  "SSLCertificateKeyFile" : "/path/to/keyfile",
                  "TransferLog" : "/var/log/site2_access_log",
                  "aliases" : "alias1.mysite.com:80 alias2.mysite.com:80",
                  "extras" : "\n  <Directory \\\"/var/tmp/dc-prod\\\">\n    AllowOverride None\n  </Directory>\n",
                  "favicon" : "/path/to/favicon",
                  "name" : "mysite.com:80",
                  "overrides" : "FileInfo Options",
                  "type" : "plain",
                  "url_aliases" : "\nAlias /special/file /override/path/here\nRewriteRule /special/url /myhandler?specialurl [PT]",
                  "vhost" : "$(sys.ipv4):80"
               }
            }
         }
      }
   }
}
